!function(e){var t={};function s(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/dist",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);s(1);class a{constructor(e,t){this.form=e,this.VirtualForm={},this.errorMessages=t.errorMessages||{},this.errorClassName=t.errorClassName||"invalid",this.successMessage=t.successMessage||"Success!",this.newValidators=t.newValidators||{},this.newValidatorsMap=t.newValidatorsMap||{},this.validators={isRequired:()=>e=>{let t;switch(typeof e){case"boolean":t=!0===e;break;default:t=""!==e}return{isValid:t,errorMessage:this.errorMessages.isRequired||"This is required field. "}},isEmail:()=>e=>{return{isValid:new RegExp("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]{2,}$").test(e),errorMessage:this.errorMessages.isEmail||"Please provide a valid email. "}},isLongerThan:e=>t=>({isValid:t.length>=e,errorMessage:`This value has to be at least ${e} characters long. `})},this.initValidation=function(){this.createVirtualForm().validate(),this.addNewValidators()},this.initValidation()}createVirtualForm(){return this.form.querySelectorAll("[name]").forEach(e=>this.saveFormElement(e)),console.log("VirtualForm: ",this.VirtualForm),this}saveFormElement(e){this.VirtualForm[e.name]={element:e,isValid:!1,isDirty:!1,errorMessages:[],validationRules:this.getValidationRules(e),customValidators:[],validRules:0,value:e.value}}addNewValidators(){this.validators={...this.validators,...this.newValidators}}getValidationRules(e){let t=[];return e.hasAttribute("required")&&t.indexOf("isRequired")<0&&t.push("isRequired"),e.dataset.validators&&(t=JSON.parse(e.dataset.validators)),this.newValidatorsMap.hasOwnProperty(e.name)&&t.push(...this.newValidatorsMap[e.name]),t}static getValue(e){switch(e.getAttribute("type")){case"checkbox":return e.checked;default:return e.value}}validateRule(e,t,s){s.value=a.getValue(t);const r=this.validators[e]()(s.value);r.isValid?this.setValid(t,s,r):this.setInvalid(t,s,r),t.parentElement.nextElementSibling.innerHTML=s.errorMessages.join(" ")}checkCustomValidators(e){const t=this.VirtualForm[e.name];t.customValidators.forEach(s=>{if(s){t.value=a.getValue(e);const r=s(t.value);r.isValid?this.setValid(e,t,r):this.setInvalid(e,t,r),e.parentElement.nextElementSibling.innerHTML=t.errorMessages.join(" ")}})}checkValidity(e){const t=this.VirtualForm[e.name];t.isDirty=!0,this.checkCustomValidators(e),t.validationRules.forEach(s=>{this.validateRule(s,e,t)})}setValid(e,t,s){e.classList.remove(this.errorClassName),t.errorMessages=t.errorMessages.filter(e=>e!==s.errorMessage),t.isValid=!0}setInvalid(e,t,s){e.classList.add(this.errorClassName),t.errorMessages.indexOf(s.errorMessage)<0&&t.errorMessages.push(s.errorMessage),t.isValid=!1}validate(){this.form.setAttribute("novalidate",!0);const e=this,t=["file","reset","submit","button"];this.form.addEventListener("blur",e=>{t.indexOf(e.target.type)>-1||this.checkValidity(e.target)},!0),this.form.addEventListener("input",t=>{e.VirtualForm[t.target.name].isDirty&&this.checkValidity(t.target)},!0),this.form.addEventListener("change",e=>{"checkbox"===e.target.type&&this.checkValidity(e.target)},!0)}validateAll(e){e.preventDefault();const t=document.querySelector(".form__message"),s=Object.keys(this.VirtualForm).length-1;let a=0,r=!1;for(let e of Object.keys(this.VirtualForm))this.checkValidity(this.VirtualForm[e].element),this.VirtualForm[e].isValid&&a++;return a===s?(r=!0,t.innerHTML=this.successMessage,t.classList.add("successful")):(t.innerHTML=this.errorMessages.final,t.classList.remove("successful")),r}setCustomValidators(e=null){return Object.keys(e).forEach(t=>{this.VirtualForm[t].customValidators=e[t]}),this}removeValidators(e=null){return Object.keys(e).forEach(t=>{e[t].forEach(e=>{const s=this.VirtualForm[t],a=s.validationRules.indexOf(e.name);if(a>-1)return s.validationRules.splice(a,1),s.validationRules})}),this}serialize(){let e={};return Object.keys(this.VirtualForm).forEach(t=>{e[t]=this.VirtualForm[t].value}),e}}const r=()=>e=>{return{isValid:void 0!==[...e].find(e=>e===e.toUpperCase()&&isNaN(e)),errorMessage:"This value has to contain at least one capital letter. "}},i={errorMessages:{final:"Please update invalid fields and hit submit again"},errorClassName:"invalid",successMessage:"Form successfully submitted!",newValidators:{hasCapitalLetter:r,hasNumber:()=>e=>({isValid:void 0!==[...e].find(e=>e.trim()&&!isNaN(e)),errorMessage:"This value has to contain at least one number. "})},newValidatorsMap:{message:["hasCapitalLetter","hasNumber"]}},l=document.querySelector("#login"),o=new a(l,i);o.setCustomValidators({name:[o.validators.isRequired("oops! required lol"),o.validators.isLongerThan(2),r()],message:[o.validators.isLongerThan(3)]}),l.addEventListener("submit",()=>{o.validateAll(event);const e=o.serialize();console.log(e)})},function(e,t){}]);